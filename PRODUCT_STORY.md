# Focus Catcher：从"Aha! Moment"到实际落地的学习助手

> 灵感来源于课代表和鸭哥新课的 "Aha! Catcher"，但我做了一个不同方向的实现——专注于**学习场景**的内容捕捉与回顾。

---

## 💡 为什么做这个产品？

### 问题场景

你是否有过这样的经历：

- 📚 在 Wikipedia 上看到一个重要概念，想记下来
- 📖 在技术博客上读到一段精彩的解释，想保存
- 💻 在 GitHub 上看到一段关键代码注释，想收藏
- 🎓 在学习过程中，零散地捕捉了很多知识点，但**回顾时却找不到重点**

传统的解决方案：
- ❌ 复制粘贴到笔记软件？**打断阅读流程**
- ❌ 浏览器书签？**只能保存整个页面，不能精确到段落**
- ❌ 截图？**不方便搜索和整理**
- ❌ 稍后读？**往往就是"稍后不读"**

### 我想要的是什么？

**零打断的学习体验**：
1. 看到重点 → 选中 → 右键点击 → 继续阅读
2. 系统自动按主题分组
3. 积累一定数量后，AI 自动生成学习回顾
4. 需要复习时，快速找到核心要点

---

## 🎯 产品设计思路

### 核心理念：遵循 AI Architect 的思想

在写代码之前，先问 **What & Why**：

**What（要解决什么问题）**
- 学习时的内容捕捉要**快速、不打断**
- 捕捉的内容要**自动分组、智能整理**
- 回顾时要**突出重点、减少记忆摩擦**

**Why（为什么这样设计）**
- 快速捕捉：右键菜单，0 学习成本
- 智能分组：AI 主题检测，无需手动管理
- 智能回顾：AI 分析生成学习要点，充当"记忆锚点"

### 技术选型：利用现有生态

不造轮子，站在巨人的肩膀上：

```
Chrome 插件（内容捕捉）
    ↓
FastAPI 后端（数据管理）
    ↓
Google Gemini AI（智能分析）
    ↓
SQLite（本地存储）
```

**为什么选择这个技术栈？**
- Chrome 插件：覆盖所有网页，用户基数大
- FastAPI：轻量、快速、易于开发
- Gemini：免费额度高、速度快、支持中英文
- SQLite：本地存储，无需服务器

---

## 🛠️ 开发过程：从 0 到 1

### 背景

- 身份：非专业前端开发者
- 工具：Cursor + Chrome DevTools
- 用时：约 3 天（断断续续）
- 经验：有 Python 后端经验，但 Chrome 插件是第一次

### 开发路径

#### Phase 1：后端先行（Day 1）

**思路**：先把数据流跑通，再做前端

```python
# 核心 API 设计
POST /api/focus/capture  # 捕捉内容
GET  /api/focus/sessions # 获取会话列表
POST /api/focus/analyze  # AI 分析
```

**踩坑 1：AI 分析返回空响应**
- 问题：使用的 API 端点对非工具调用返回空内容
- 解决：切换到 Google Gemini API，问题解决

**踩坑 2：Markdown 格式污染**
- 问题：AI 返回的内容包含大量 Markdown 符号
- 解决：在 prompt 中明确要求纯文本输出，并在后端清理 HTML 标签

#### Phase 2：Chrome 插件（Day 2）

**思路**：从简单到复杂，先实现基础功能

1. ✅ Manifest V3 配置
2. ✅ Content Script 注入
3. ✅ Background Service Worker
4. ✅ 右键菜单集成

**踩坑 3：快捷键不工作**
- 问题：以为可以在设置页面动态修改快捷键
- 真相：Chrome 插件的快捷键必须在系统设置中配置
- 解决：改为右键菜单，0 配置，开箱即用

**踩坑 4：CSP 错误**
- 问题：设置页面使用了内联事件处理器（`onmouseover`）
- 解决：移除内联事件，改用 CSS `:hover`

**踩坑 5：右键菜单捕捉失败**
- 问题：通过 content script 获取选中文字时，文字已被取消
- 解决：直接在 background.js 中使用 `info.selectionText`

#### Phase 3：智能主题检测（Day 3）

**思路**：不用时间分割会话，而是用 AI 判断主题切换

```python
def detect_topic_shift(new_text, recent_captures):
    # 使用 Gemini 比较新旧内容
    # 判断是否属于同一学习主题
    return is_related, confidence
```

**效果**：
- ✅ 学习 React Hooks 几小时 → 保持在同一会话
- ✅ 从 React 切换到 Python → 自动创建新会话
- ✅ 无需手动管理，完全自动化

---

## ✨ 最终实现的功能

### 1. 快速捕捉（零打断）

**三种方式**：
- 🥇 **右键菜单**（推荐）：选中文字 → 右键 → Focus Catcher
- 🥈 **快捷键**：选中文字 → 按快捷键（需设置）
- 🥉 **插件图标**：查看统计和历史

**响应速度**：< 100ms

### 2. 智能分组（AI 驱动）

**自动主题检测**：
- 使用 Gemini AI 比较新旧内容
- 置信度 > 0.6 才创建新会话
- 无时间限制，真正按主题分组

**示例**：
```
会话 1: React Hooks 学习
  - useState 用于状态管理
  - useEffect 用于副作用
  - useContext 用于共享数据

会话 2: Python 数据处理
  - 列表推导式语法
  - pandas DataFrame 操作
  - numpy 数组运算
```

### 3. AI 回顾（记忆锚点）

**分析维度**：
- 🎯 核心主题：你在学什么？
- 📚 关键信息点：重点是什么？
- 🔗 内容脉络：知识如何关联？
- ✅ 已覆盖的内容：你已经掌握了什么？
- ❓ 可能需要进一步查阅：还有哪些疑问？
- 💡 回顾建议：下一步怎么做？
- 📝 原文回顾：完整的捕捉内容

**输出格式**：纯文本，易于阅读

### 4. 完整的数据管理

- ✅ 查看所有会话和捕捉
- ✅ 删除不需要的会话
- ✅ 导出学习记录（计划中）
- ✅ 跨设备同步（计划中）

---

## 📊 与"Aha! Catcher"的对比

| 维度 | Aha! Catcher（原版） | Focus Catcher（我的实现） |
|------|---------------------|------------------------|
| **场景** | 灵感捕捉 | 学习内容捕捉 |
| **触发方式** | 语音录音（手表） | 文字选中（网页） |
| **输入** | 音频 | 文字 |
| **处理** | 语音转文字 + AI 总结 | AI 主题检测 + 学习分析 |
| **输出** | 灵感笔记 | 学习回顾 |
| **平台** | Android（三星生态） | Chrome（跨平台） |
| **核心价值** | 随时随地记录灵感 | 零打断的学习体验 |

**共同点**：
- ✅ 都强调"快速捕捉"
- ✅ 都使用 AI 增强内容
- ✅ 都注重用户体验

**不同点**：
- 🎯 场景不同：灵感 vs 学习
- 🎯 输入不同：语音 vs 文字
- 🎯 平台不同：移动 vs 桌面

---

## 🎓 我学到了什么

### 1. AI Architect 的思维方式

**先问 What & Why，再写 How**：
- ❌ 不要一上来就写代码
- ✅ 先明确问题和解决方案
- ✅ 利用现有生态，不造轮子

### 2. 开发中的"取舍"

**完美主义 vs 快速迭代**：
- ❌ 一开始想做快捷键自定义（复杂）
- ✅ 改为右键菜单（简单、好用）
- ❌ 一开始想做实时同步（复杂）
- ✅ 改为本地存储（简单、快速）

### 3. AI 辅助开发的正确姿势

**Cursor 不是万能的**：
- ✅ 用 Cursor 生成基础代码
- ✅ 用 Cursor 快速调试
- ❌ 不要盲目信任 AI 的建议
- ✅ 关键问题要自己查文档

### 4. Chrome 插件开发的坑

**避雷指南**：
- 🚨 快捷键必须在 Chrome 系统设置中配置
- 🚨 不能使用内联事件处理器（CSP 限制）
- 🚨 右键菜单的 `info.selectionText` 最可靠
- 🚨 插件更新后要刷新插件和网页

---

## 🚀 未来计划

### P0（必须做）
- [ ] 插件内查看历史记录
- [ ] 优化 AI 分析的 prompt
- [ ] 添加导出功能

### P1（应该做）
- [ ] 支持图片捕捉
- [ ] 支持代码高亮
- [ ] 添加标签系统
- [ ] 跨设备同步

### P2（可以做）
- [ ] 学习统计图表
- [ ] 知识图谱可视化
- [ ] 团队协作功能
- [ ] 移动端支持

---

## 💬 写在最后

### 为什么分享这个项目？

1. **验证学习成果**：把课程学到的理念应用到实际项目
2. **帮助同路人**：分享踩坑经历，让后来者少走弯路
3. **寻求反馈**：希望得到社区的建议和改进意见
4. **开源精神**：代码已开源，欢迎贡献

### 给想做类似项目的同学

**建议**：
- ✅ 从自己的真实需求出发
- ✅ 先做 MVP，快速验证
- ✅ 利用现有工具和 API
- ✅ 不要追求完美，先跑通流程
- ✅ 多看文档，少信 AI

**资源**：
- Chrome 插件开发：[Chrome Extensions Documentation](https://developer.chrome.com/docs/extensions/)
- FastAPI：[FastAPI Documentation](https://fastapi.tiangolo.com/)
- Google Gemini：[Gemini API Documentation](https://ai.google.dev/)

---

## 📦 项目信息

- **项目名称**：Focus Catcher
- **开发时间**：3 天（断断续续）
- **技术栈**：Chrome Extension + FastAPI + Gemini AI
- **代码行数**：~2000 行
- **开源地址**：（待添加）
- **演示视频**：（待添加）

---

## 🙏 致谢

- 感谢课代表和鸭哥的新课，提供了"Aha! Catcher"的灵感
- 感谢 Cursor 和 Claude，大大提高了开发效率
- 感谢 Google Gemini，提供了强大的 AI 能力
- 感谢所有测试用户的反馈

---

**如果你也在做类似的项目，或者有任何建议，欢迎交流！** 🚀

---

*最后更新：2024-12-19*

